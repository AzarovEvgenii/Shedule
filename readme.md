Самостоятельная работа № 2: «Вас здесь не стояло!»
============================================

Данный файл содержит все необходимые комментарии к заданию.

## Структура проекта

Проект структурирован в соответствии с принятыми стандартами и содержит следующие каталоги и файлы верхнего уровня:

* `/src` — исходные платформо-мало-или-почти-независимые коды;
* `/tests` — тесты
* `CMakeLists.txt` — корневой файл «проекта» для системы построения систем сборки CMake.
* `readme.md` — ридмишка с комментариями к содержимому текущего каталога в формате Markdown.


### Описание задания

> А люди все роптали и роптали, <br>
> А люди справедливости хотят: <br>
> – Мы в очереди первыe стояли, <br>
> А те, кто сзади нас, – уже едят. <br>
>
> -- <cite>В. С. Высоцкий</cite>

_Очередь_, реализующая дисциплину обслуживания FIFO, в идеальном мире олицетворяет модель справедливого доступа к ограниченному по пропускной способности ресурсу согласно формуле: «кто первый встал, — того и тапки». Но как известно, даже в идеальном мире, где все равны, кто-то всегда оказывается _ровнее_, и, заняв место в самом _хвосте_ очереди, совершенно неожиданно для ее _головы_ может первым получить доступ к заветному ресурсу. 
Каждому знакома ситуация, когда после длительного ожидания своей _очереди_ на приеме у стоматолога, пациент в голове очереди уже готов сделать _dequeue_, как вдруг перед самым его носом в кабинет проскальзывает _более приоритетный_ пациент, с которым первый пациент даже не успел познакомиться.

_Очередь двойной справедливости_ — пользуется популярностью как в корпоративной, так и — особенно — в муниципальной среде. Задача экономически-ориентированного программиста — удовлетворить растущие потребности рынка, реализовав программно такую очередь в виде параметризованного класса `TrickyQueue`.

 ![](docs/queue.jpg)

#### Класс TrickyQueue

Шаблон класса `TrickyQueue` описывается в файле [tricky_queue.h](src/tricky_queue.h).  
Имеет два шаблонных параметра:
* `T`  — определяет вид «клиентов» очереди.
* `PrivilegeFunc` — является «аналитическим отделом по работе с привилегированными клиентами», мастерски разделяющим всех клиентов на «обычных» и «привилегированных». 

К типу данных `T` предъявляются требования, аналогичные тем, которые предъявляются к элементам большинства контейнеров стандартной библиотеки (можно ориентироваться на контейнер `vector<T>` при обращении к справочной документации).

Тип `PrivilegeFunc` является _функциональным объектом_ или _функтором_ (https://www.geeksforgeeks.org/functors-in-cpp/ ; https://stackoverflow.com/questions/356950/what-are-c-functors-and-their-uses) и реализуется обычно в виде класса (или структуры), содержащего обязательный компонент — перегруженный оператор вызова (круглые скобки). Соответствующая операторная функция в качестве параметра получает объект — клиента очереди и возвращает булево значение, определяющее, является ли клиент «привилегированным» (`true`) или не является (`false`).

Класс `TrickyQueue` содержит два основных метода для манипуляции с очередью:

* метод `void enq(const T& obj)` помещает объект (клиента) `obj` в конец очереди;
* метод `T deq()` извлекает очередной объект (клиента) из очереди по следующему правилу: сперва из очереди извлекаются привилегированные клиенты, затем все остальные. Важно, что и привилегированные, и обычные клиенты очереди извлекаются строго в том порядке, в котором они заняли свое место, но — сначала все привилегированные, а затем простые.

Внутренняя структура очереди и алгоритм извлечения реализуются на усмотрение программиста.  

Во избежание волнений и подстрекательства к бунту, в очереди с привилегиями предусмотрен режим bypass, в котором при большом числе привилегированных клиентов каждый _k_-тый клиент из очереди в обязательном порядке извлекается среди «обычных» клиентов. Значение _k_ задается в виде параметра конструктора `TrickyQueue`.

* Если в очереди наличествуют только "простые" клиенты, они пропускаются подряд.
* Если в очереди наличествуют только "привилегированные" клиенты, они также пропускаются подряд, даже если счетчик привилегированных клиентов превысил значение _k_.


#### Типы IntTrickyQueue и IntFunctor, Person и PersonState

Пример очереди, содержащей в качестве клиентов целые числа (`T = int`), описывается типом данных `IntTrickyQueue`, и представлен в файле [queue_clients.h](src/queue_clients.h). Там же приведен полный пример класса-функтора `IntFunctor`, который определяет среди целочисленных клиентов привилегированными таких, чье собственное значение не менее волшебной константы 42. Ориентируйтесь на этот пример, как на полностью рабочий.

Также у вас есть тип клиентов «Персона» `Person`, для которого вам необходимо реализовать функтор `PersonState`.
Приоритетными считаются клиенты, для которых выполняется хотя бы одно из условий:

1) Количество денежных знаков не меньше 1000,
2) Возраст не моложе 65,
3) Имя начинается на латинскую букву 'S' (регистр верхний).

Подробности в файле [queue_clients.h](src/queue_clients.h).

#### Что надо сделать

1. Реализовать все задекларированные методы класса `TrickyQueue` непосредственно в файле [tricky_queue.h](src/tricky_queue.h) (**вынос тел методов в другие файлы не предусмотрен**). При необходимости класс `TrickyQueue` можно дополнять методами, полями, описаниями типов.
2. Реализовать функтор `PersonState`, в соответствии с правилами, приведенными в комментариях. Оба класса описаны в файле [queue_clients.h](src/queue_clients.h) (**вынос тел методов в другие файлы также не предусмотрен**).
3. Проверить работоспособность очереди на предложенных тестах и внедрить разработку в жизнь.


Удачи!